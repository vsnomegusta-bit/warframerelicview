<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Warframe - Database Manager Fix</title>
    <style>
        :root { --gold: #c19b4b; --bg: #0d1117; --card: #161b22; --text: #c9d1d9; --red: #f85149; --green: #238636; }
        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; padding: 20px; }
        .container { max-width: 1000px; margin: auto; }
        
        .admin-bar { background: #21262d; padding: 20px; border-radius: 8px; margin-bottom: 20px; border: 1px solid var(--gold); text-align: center; }
        .admin-bar input { padding: 10px; border-radius: 4px; border: 1px solid #30363d; background: #0d1117; color: white; width: 200px; }
        
        .btn { border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: bold; transition: 0.2s; margin: 5px; }
        .btn-gold { background: var(--gold); color: black; }
        .btn-green { background: var(--green); color: white; }
        .btn-danger { background: var(--red); color: white; font-size: 0.7em; padding: 4px 8px; }

        /* Esconde as ferramentas por padr칚o */
        .editor-tool { display: none; }
        .unlocked .editor-tool { display: inline-block; }
        .unlocked #login-area { display: none; }

        .relic-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }
        .relic-card { background: var(--card); border-radius: 10px; padding: 15px; border: 1px solid #30363d; }
        .relic-header { border-bottom: 1px solid #333; margin-bottom: 10px; padding-bottom: 5px; display: flex; justify-content: space-between; align-items: center;}
        
        .item-row { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #21262d; }
        .price-tag { color: #3fb950; font-weight: bold; cursor: pointer; padding: 5px; border-radius: 4px; }
        .price-tag:hover { background: rgba(63, 185, 80, 0.1); }
        
        .search-box { display: flex; gap: 10px; margin-bottom: 20px; }
        .search-box input, .search-box select { padding: 12px; border-radius: 6px; border: 1px solid #30363d; background: var(--card); color: white; flex: 1; }
    </style>
</head>
<body>

<div class="container">
    <h1 style="text-align: center; color: var(--gold);">Gerenciador de Rel칤quias</h1>

    <div class="admin-bar">
        <div id="login-area">
            <input type="password" id="passInput" placeholder="Senha: 1234">
            <button class="btn btn-gold" onclick="autenticar()">DESBLOQUEAR EDI칂츾O</button>
        </div>
        <div id="tool-area" class="editor-tool">
            <p style="color: var(--green); margin-bottom: 15px;">游댑 MODO EDITOR ATIVO</p>
            <button class="btn btn-green" onclick="addReliquia()">+ Nova Rel칤quia</button>
            <button class="btn" style="background:#444; color:white;" onclick="exportar()">游닋 Copiar Dados p/ Amigo</button>
            <button class="btn" style="background:#444; color:white;" onclick="importar()">游닌 Colar Dados do Amigo</button>
        </div>
    </div>

    <div class="search-box">
        <input type="text" id="txtBusca" placeholder="Pesquisar..." onkeyup="filtrar()">
        <select id="selEra" onchange="filtrar()">
            <option value="">Todas as Eras</option>
            <option value="Lith">Lith</option>
            <option value="Meso">Meso</option>
            <option value="Neo">Neo</option>
            <option value="Axi">Axi</option>
        </select>
    </div>

    <div id="listaReliquias" class="relic-grid"></div>
</div>

<script>
    // SENHA PADR츾O: 1234
    const SENHA_CORRETA = "1234";

    // Dados Iniciais
    let bancoDados = [
        { era: "Axi", nome: "Axi G11", itens: [{ n: "Grendel Prime BP", p: 15 }] }
    ];

    // Carregar do Navegador se existir
    const localData = localStorage.getItem('warframe_db_v2');
    if (localData) bancoDados = JSON.parse(localData);

    function autenticar() {
        const senha = document.getElementById('passInput').value;
        if (senha === SENHA_CORRETA) {
            document.body.classList.add('unlocked');
        } else {
            alert("Senha Incorreta!");
        }
    }

    function renderizar() {
        const grid = document.getElementById('listaReliquias');
        grid.innerHTML = '';

        bancoDados.forEach((reliquia, rIdx) => {
            const card = document.createElement('div');
            card.className = 'relic-card';
            card.setAttribute('data-era', reliquia.era);
            card.setAttribute('data-search', (reliquia.nome + " " + reliquia.itens.map(i => i.n).join(" ")).toLowerCase());

            let html = `
                <div class="relic-header">
                    <div>
                        <b style="color:var(--gold)">${reliquia.nome}</b><br>
                        <small>${reliquia.era}</small>
                    </div>
                    <button class="btn-danger editor-tool" onclick="removerReliquia(${rIdx})">Apagar</button>
                </div>
            `;

            reliquia.itens.forEach((item, iIdx) => {
                html += `
                    <div class="item-row">
                        <span>${item.n}</span>
                        <div>
                            <span class="price-tag" onclick="editarPreco(${rIdx}, ${iIdx})">${item.p} PL</span>
                            <button class="btn-danger editor-tool" onclick="removerItem(${rIdx}, ${iIdx})" style="margin-left:5px">X</button>
                        </div>
                    </div>
                `;
            });

            html += `<button class="btn btn-green editor-tool" style="width:100%; margin-top:10px" onclick="adicionarItem(${rIdx})">+ Item</button>`;
            
            card.innerHTML = html;
            grid.appendChild(card);
        });
    }

    // FUN칂칏ES DE EDI칂츾O
    function addReliquia() {
        const nome = prompt("Nome da Rel칤quia (ex: Neo P22):");
        const era = prompt("Era (Lith, Meso, Neo ou Axi):");
        if (nome && era) {
            bancoDados.push({ era, nome, itens: [] });
            salvar();
        }
    }

    function removerReliquia(idx) {
        if (confirm("Apagar toda a rel칤quia?")) {
            bancoDados.splice(idx, 1);
            salvar();
        }
    }

    function adicionarItem(rIdx) {
        const nome = prompt("Nome do Item:");
        const preco = prompt("Pre칞o inicial:", "0");
        if (nome) {
            bancoDados[rIdx].itens.push({ n: nome, p: parseInt(preco) });
            salvar();
        }
    }

    function removerItem(rIdx, iIdx) {
        bancoDados[rIdx].itens.splice(iIdx, 1);
        salvar();
    }

    function editarPreco(rIdx, iIdx) {
        if (!document.body.classList.contains('unlocked')) {
            alert("Desbloqueie o editor com a senha primeiro!");
            return;
        }
        const novo = prompt("Novo Pre칞o para " + bancoDados[rIdx].itens[iIdx].n, bancoDados[rIdx].itens[iIdx].p);
        if (novo !== null) {
            bancoDados[rIdx].itens[iIdx].p = parseInt(novo);
            salvar();
        }
    }

    function salvar() {
        localStorage.setItem('warframe_db_v2', JSON.stringify(bancoDados));
        renderizar();
    }

    // SYNC
    function exportar() {
        const code = btoa(JSON.stringify(bancoDados));
        navigator.clipboard.writeText(code);
        alert("C칩digo de sincroniza칞칚o copiado! Envie para seu amigo.");
    }

    function importar() {
        const code = prompt("Cole o c칩digo do seu amigo aqui:");
        if (code) {
            try {
                bancoDados = JSON.parse(atob(code));
                salvar();
                alert("Dados sincronizados!");
            } catch(e) { alert("C칩digo inv치lido!"); }
        }
    }

    function filtrar() {
        const q = document.getElementById('txtBusca').value.toLowerCase();
        const e = document.getElementById('selEra').value;
        document.querySelectorAll('.relic-card').forEach(c => {
            const matchesSearch = c.getAttribute('data-search').includes(q);
            const matchesEra = e === "" || c.getAttribute('data-era') === e;
            c.style.display = (matchesSearch && matchesEra) ? "block" : "none";
        });
    }

    renderizar();
</script>

</body>
</html>